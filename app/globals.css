@import "tailwindcss";

/* ============================================
   LIGHT MODE - DEFAULT THEME
   ============================================ */
:root {
  /* Background System */
  --background: #F5F1E8;
  --foreground: #171717;
  --body-bg: #F5F1E8;
  --surface-1: #FFFFFF;
  --surface-2: #F9F9F9;
  --surface-3: #F3F3F3;
  --border: #E5E5E5;
  --divider: #EEEEEE;

  /* Primary Color - Emerald (#009966) for Light Mode */
  --color-primary: #009966;
  --color-primary-light: #10b981;
  --color-primary-dark: #047857;
  --color-primary-rgb: 0, 153, 102;

  /* Secondary Color */
  --color-secondary: #FF6CCF;
  --color-secondary-light: #FF8CDA;
  --color-secondary-dark: #D94FAE;

  /* Semantic Colors */
  --color-success: #10b981;
  --color-warning: #f59e0b;
  --color-danger: #ef4444;
  --color-info: #3b82f6;

  /* Text Colors */
  --text-primary: #1F2937;
  --text-secondary: #6B7280;
  --text-tertiary: #9CA3AF;
  --text-inverse: #FFFFFF;

  /* Additional UI Colors */
  --color-muted: #F3F4F6;
  --color-accent: #F59E0B;

  /* Overlay & Shadow */
  --overlay: rgba(0, 0, 0, 0.4);
  --shadow-soft: rgba(0, 0, 0, 0.08);
  --shadow-strong: rgba(0, 0, 0, 0.15);
}

/* ============================================
   DARK MODE - CUSTOM THEME
   ============================================ */
:root.dark {
  /* Background System - Dark Mode - Ultra Modern with Emerald Accent */
  --background: #081210;
  --foreground: #F5F5F5;
  --body-bg: #081210;
  --surface-1: #0F1A17;
  --surface-2: #152420;
  --surface-3: #1C2D28;
  --border: #1F3730;
  --divider: #14201C;

  /* Primary Color - Emerald with Glow Effect */
  --color-primary: #10B981;
  --color-primary-light: #34D399;
  --color-primary-dark: #059669;
  --color-primary-rgb: 16, 185, 129;

  /* Secondary Color - Electric Purple */
  --color-secondary: #A855F7;
  --color-secondary-light: #C084FC;
  --color-secondary-dark: #9333EA;

  /* Semantic Colors - Premium Vibrant */
  --color-success: #10B981;
  --color-warning: #F59E0B;
  --color-danger: #F43F5E;
  --color-info: #06B6D4;

  /* Text Colors - Premium Contrast */
  --text-primary: #F5F5F5;
  --text-secondary: #A8A8A8;
  --text-tertiary: #6B6B6B;
  --text-inverse: #081210;

  /* Additional UI Colors */
  --color-muted: #0F1A17;
  --color-accent: #F59E0B;

  /* Overlay & Shadow - Enhanced Depth */
  --overlay: rgba(8, 18, 16, 0.85);
  --shadow-soft: 0 2px 8px rgba(0, 0, 0, 0.4);
  --shadow-strong: 0 8px 24px rgba(0, 0, 0, 0.6);
  --glow-primary: 0 0 20px rgba(16, 185, 129, 0.3);
  --glow-secondary: 0 0 20px rgba(168, 85, 247, 0.3);
  
  /* Emerald Tint for Cards */
  --card-border: rgba(16, 185, 129, 0.15);
  --card-hover-bg: rgba(16, 185, 129, 0.08);
}

/* System Dark Mode Preference */
@media (prefers-color-scheme: dark) {
  :root:not(.light) {
    /* Background System - Dark Mode - Ultra Modern with Emerald Accent */
    --background: #081210;
    --foreground: #F5F5F5;
    --body-bg: #081210;
    --surface-1: #0F1A17;
    --surface-2: #152420;
    --surface-3: #1C2D28;
    --border: #1F3730;
    --divider: #14201C;

    /* Primary Color - Emerald with Glow Effect */
    --color-primary: #10B981;
    --color-primary-light: #34D399;
    --color-primary-dark: #059669;
    --color-primary-rgb: 16, 185, 129;

    /* Secondary Color - Electric Purple */
    --color-secondary: #A855F7;
    --color-secondary-light: #C084FC;
    --color-secondary-dark: #9333EA;

    /* Semantic Colors - Premium Vibrant */
    --color-success: #10B981;
    --color-warning: #F59E0B;
    --color-danger: #F43F5E;
    --color-info: #06B6D4;

    /* Text Colors - Premium Contrast */
    --text-primary: #F5F5F5;
    --text-secondary: #A8A8A8;
    --text-tertiary: #6B6B6B;
    --text-inverse: #081210;

    /* Additional UI Colors */
    --color-muted: #0F1A17;
    --color-accent: #F59E0B;

    /* Overlay & Shadow - Enhanced Depth */
    --overlay: rgba(8, 18, 16, 0.85);
    --shadow-soft: 0 2px 8px rgba(0, 0, 0, 0.4);
    --shadow-strong: 0 8px 24px rgba(0, 0, 0, 0.6);
    --glow-primary: 0 0 20px rgba(16, 185, 129, 0.3);
    --glow-secondary: 0 0 20px rgba(168, 85, 247, 0.3);
    
    /* Emerald Tint for Cards */
    --card-border: rgba(16, 185, 129, 0.15);
    --card-hover-bg: rgba(16, 185, 129, 0.08);
  }
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);

  /* Custom Color Tokens for Tailwind */
  --color-body: var(--body-bg);
  --color-surface-1: var(--surface-1);
  --color-surface-2: var(--surface-2);
  --color-surface-3: var(--surface-3);
  --color-border: var(--border);
  --color-divider: var(--divider);
  
  --color-text-primary: var(--text-primary);
  --color-text-secondary: var(--text-secondary);
  --color-text-tertiary: var(--text-tertiary);
  --color-text-inverse: var(--text-inverse);
}

/* View Transitions API Support */
@view-transition {
  navigation: auto;
}

/* Prevent white flash during view transitions */
::view-transition-old(root),
::view-transition-new(root) {
  animation-duration: 0.2s;
  animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  mix-blend-mode: normal;
}

::view-transition-old(root) {
  animation-name: fade-out;
}

::view-transition-new(root) {
  animation-name: fade-in;
}

/* Ensure background stays consistent during transition */
::view-transition-group(root) {
  animation-duration: 0.2s;
}

@keyframes fade-out {
  from { opacity: 1; }
  to { opacity: 0.98; }
}

@keyframes fade-in {
  from { opacity: 0.98; }
  to { opacity: 1; }
}

/* Prevent layout shift during page transitions */
* {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Critical: Prevent any white flash during navigation */
html,
body,
#__next,
main,
[data-nextjs-scroll-focus-boundary] {
  background-color: inherit !important;
}

/* Prevent white flash on route transitions */
html::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: inherit;
  z-index: -1;
  pointer-events: none;
}

/* Hardware acceleration for smoother rendering */
.page-container,
main,
article,
section {
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* Optimize rendering with content-visibility */
section:not([data-no-optimize]),
article:not([data-no-optimize]) {
  content-visibility: auto;
  contain-intrinsic-size: auto 500px;
}

/* Fix iOS overscroll black area - Critical for PWA */
html {
  -ms-content-zooming: none;
  /* Allow pinch zoom but disable double-tap zoom */
  -ms-touch-action: manipulation;
  touch-action: manipulation;
  /* Background must be set to cover overscroll area */
  background: var(--background);
  /* iOS 26 Safari: Use dynamic viewport height (dvh) for better support */
  min-height: 100dvh;
  min-height: 100vh;
  /* iOS specific viewport fill */
  min-height: -webkit-fill-available;
  /* Smooth scrolling for iOS */
  -webkit-overflow-scrolling: touch;
  /* Remove transform that can affect fixed positioning */
  transform: none !important;
  -webkit-transform: none !important;
  /* Smooth color scheme transition */
  color-scheme: light dark;
  /* NO transition by default - will be enabled by .transitions-enabled class */
}

/* Light mode default background */
html:not(.dark) {
  background-color: #F5F1E8;
}

/* Dark mode background */
html.dark {
  background-color: #081210;
}

body {
  background: var(--body-bg);
  color: var(--text-primary);
  font-family: Arial, Helvetica, sans-serif;
  /* Allow pinch zoom but disable double-tap zoom */
  touch-action: manipulation;
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-text-size-adjust: none;
  /* iOS safe area insets - prevent content behind status bar/notch */
  padding-top: env(safe-area-inset-top, 0px);
  padding-bottom: env(safe-area-inset-bottom, 0px);
  padding-left: env(safe-area-inset-left, 0px);
  padding-right: env(safe-area-inset-right, 0px);
  /* Ensure body fills viewport and extends for overscroll */
  /* iOS 26 Safari: Dynamic viewport height */
  min-height: 100dvh;
  min-height: 100vh;
  min-height: -webkit-fill-available;
  /* Remove transform that can affect fixed positioning */
  transform: none !important;
  -webkit-transform: none !important;
  /* Smooth scrolling */
  -webkit-overflow-scrolling: touch;
  /* NO transition by default - will be enabled by .transitions-enabled class */
}

/* Only add transitions after page load - controlled by ThemeProvider */
html.transitions-enabled {
  transition: background-color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

html.transitions-enabled body {
  transition: background-color 0.3s cubic-bezier(0.4, 0, 0.2, 1),
              color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Additional zoom prevention */
* {
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  /* Disable double-tap zoom, allow pinch zoom */
  touch-action: manipulation;
}

/* Allow text selection and normal touch behavior for inputs */
input, 
textarea, 
select,
[contenteditable] {
  -webkit-user-select: auto;
  user-select: auto;
  touch-action: auto;
}

/* Allow scrolling on specific elements */
[data-scroll],
.scroll-container {
  touch-action: pan-y;
}

/* Ensure iOS safe-area zones show the app background color (status bar area) */
.safe-area-top {
  background: var(--background);
  padding-top: env(safe-area-inset-top);
}

.safe-area-bottom {
  background: var(--background);
  padding-bottom: env(safe-area-inset-bottom);
}

/* iOS PWA: Safe area handled by body padding */

/* For pages that use full viewport */
.pwa-safe-top {
  padding-top: env(safe-area-inset-top);
}

.pwa-safe-bottom {
  padding-bottom: env(safe-area-inset-bottom);
}

/* NProgress Loading Bar Customization */
#nprogress {
  pointer-events: none;
}

#nprogress .bar {
  background: linear-gradient(90deg, var(--color-primary), var(--color-primary-dark)) !important;
  position: fixed;
  z-index: 9999;
  top: 0;
  left: 0;
  width: 100%;
  height: 3px;
}

#nprogress .peg {
  display: block;
  position: absolute;
  right: 0px;
  width: 100px;
  height: 100%;
  box-shadow: 0 0 10px var(--color-primary), 0 0 5px var(--color-primary);
  opacity: 1;
  transform: rotate(3deg) translate(0px, -4px);
}

/* QR Scanner Animations */
@keyframes scan-line {
  0% {
    top: 0%;
  }
  50% {
    top: 100%;
  }
  100% {
    top: 0%;
  }
}

.animate-scan-line {
  animation: scan-line 2.5s ease-in-out infinite;
}

/* QR Scanner Camera Styling */
#qr-reader-mobile video,
#qr-reader-desktop video {
  object-fit: cover !important;
  width: 100% !important;
  height: 100% !important;
}

#qr-reader-mobile,
#qr-reader-desktop {
  border: none !important;
}

#qr-reader-mobile > div,
#qr-reader-desktop > div {
  border: none !important;
}
